# 問2

複数のスレッドがある共有のメモリを同時に読み書きするような状況を考えます。

具体的には、以下の Python コードで表される関数 `write_data` と `read_data` を複数のスレッドが同時に呼び出すと想定してください。

```python
def write_data():
    write_shared_memory()


def read_data():
    read_shared_memory()
```

`write_shared_memory` 関数と `read_shared_memory` 関数は、全スレッドで共有されるメモリへの書き込み操作と読み込み操作を行います。また、これらの関数には排他制御に関する処理は一切含まれていません。

共有メモリへのアクセスについて、様々な条件を満たすよう `write_data` と `read_data` に排他制御の処理を組み込みたいと思います。このとき、以下の各問題に答えてください。

## 問題A

共有メモリへの読み書きが安全に行われ、かつ以下の条件を満たすように排他制御を組み込むことを考えます。

**条件:**

- 共有メモリへのアクセス (読み・書きを問わない) を行っているスレッドは常に 1 つ以下でなければならない。

上記の要件を満たすような `write_data` と `read_data` の実装として正しいものはどれですか。リポジトリの `no2/` 以下に存在する `A_1.py`, `A_2.py`, `A_3.py` の中から選んでください。

## 問題B

共有メモリに対する書き込み操作を行っているスレッドがいない状態であれば、読み込み操作は同時に複数スレッドから行われても問題を生じないので、条件を次のように緩和することにします。

**条件:**

- 共有メモリへの書き込み操作を行っているスレッドは常に 1 つ以下でなければならない。
- 共有メモリへの書き込み操作を行っているスレッドが存在するとき、どのスレッドも共有メモリからの読み込み操作を行ってはならない。
- 共有メモリへの書き込み操作を行っているスレッドが存在しないとき、複数のスレッドが同時に共有メモリからの読み込み操作を行うことができる。

上記の要件を満たすような `write_data` と `read_data` の実装として正しいものはどれですか。リポジトリの `no2/` 以下に存在する `B_1.py`, `B_2.py`, `B_3.py` の中から選んでください。
